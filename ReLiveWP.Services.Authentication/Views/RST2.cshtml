@model ReLiveWP.Services.Authentication.Models.RST2Model

<?xml version="1.0" encoding="utf-8" ?>
<S:Envelope xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:wsa="http://www.w3.org/2005/08/addressing">
    <S:Header>
        <wsa:Action xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="Action" S:mustUnderstand="1">http://schemas.xmlsoap.org/ws/2005/02/trust/RSTR/Issue</wsa:Action>
        <wsa:To xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wsa="http://www.w3.org/2005/08/addressing" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="To" S:mustUnderstand="1">http://schemas.xmlsoap.org/ws/2004/08/addressing/role/anonymous</wsa:To>
        <wsse:Security S:mustUnderstand="1">
            <wsu:Timestamp xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" wsu:Id="TS">
                <wsu:Created>@Model.TimeZ</wsu:Created>
                <wsu:Expires>@Model.Time5MZ</wsu:Expires>
            </wsu:Timestamp>
        </wsse:Security>
        <psf:pp xmlns:psf="http://schemas.microsoft.com/Passport/SoapServices/SOAPFault">
            <psf:serverVersion>1</psf:serverVersion>
            <psf:PUID>@Model.PUIDHex</psf:PUID>
            <psf:configVersion>7.000.13347.00</psf:configVersion>
            <psf:uiVersion>3.100.2179.0</psf:uiVersion>
            <psf:mobileConfigVersion>7.000.13347.0</psf:mobileConfigVersion>
            <psf:appDataVersion>1</psf:appDataVersion>
            <psf:authstate>0x48803</psf:authstate>
            <psf:reqstatus>0x0</psf:reqstatus>
            <psf:serverInfo Path="Live1" RollingUpgradeState="ExclusiveNew" LocVersion="0" ServerTime="@Model.TimeZ">XYZPPLOGN1A23 2017.09.28.12.44.07</psf:serverInfo>
            <psf:cookies />
            <psf:browserCookies>
                <psf:browserCookie Name="MH" URL="http://www.msn.com">MSFT; path=/; domain=.msn.com; expires=Wed, 30-Dec-2037 16:00:00 GMT</psf:browserCookie>
                <psf:browserCookie Name="MHW" URL="http://www.msn.com">; path=/; domain=.msn.com; expires=Thu, 30-Oct-1980 16:00:00 GMT</psf:browserCookie>
                <psf:browserCookie Name="MH" URL="http://www.live.com">MSFT; path=/; domain=.live.com; expires=Wed, 30-Dec-2037 16:00:00 GMT</psf:browserCookie>
                <psf:browserCookie Name="MHW" URL="http://www.live.com">; path=/; domain=.live.com; expires=Thu, 30-Oct-1980 16:00:00 GMT</psf:browserCookie>
                <psf:browserCookie Name="BEARER" URL="http://www.msn.com">@Model.Token; path=/; domain=.msn.com; expires=Wed, 30-Dec-2037 16:00:00 GMT</psf:browserCookie>
                <psf:browserCookie Name="BEARER" URL="http://www.live.com">@Model.Token; path=/; domain=.live.com; expires=Wed, 30-Dec-2037 16:00:00 GMT</psf:browserCookie>
            </psf:browserCookies>
            <psf:credProperties>
                <psf:credProperty Name="MainBrandID">MSFT</psf:credProperty>
                <psf:credProperty Name="BrandIDList"></psf:credProperty>
                <psf:credProperty Name="IsWinLiveUser">true</psf:credProperty>
                <psf:credProperty Name="CID">@Model.CID</psf:credProperty>
                <psf:credProperty Name="AuthMembername">@Model.Email</psf:credProperty>
                <psf:credProperty Name="Country">US</psf:credProperty>
                <psf:credProperty Name="Language">1033</psf:credProperty>
                <psf:credProperty Name="FirstName">@Model.FirstName</psf:credProperty>
                <psf:credProperty Name="LastName">@Model.LastName</psf:credProperty>
                <psf:credProperty Name="ChildFlags">00000001</psf:credProperty>
                <psf:credProperty Name="Flags">40100643</psf:credProperty>
                <psf:credProperty Name="FlagsV2">00000000</psf:credProperty>
                <psf:credProperty Name="IP">@Model.IP</psf:credProperty>
                <psf:credProperty Name="AssociatedForStrongAuth">0</psf:credProperty>
            </psf:credProperties>
            <psf:extProperties>
                <psf:extProperty Name="ANON" Expiry="Wed, 30-Dec-2037 16:00:00 GMT" Domains="bing.com;atdmt.com;live.com;" IgnoreRememberMe="false">A=B97FB2EE7DB4CE0D0D5B8107FFFFFFFF&amp;E=1542&amp;W=1</psf:extProperty>
                <psf:extProperty Name="BEARER" Expiry="Wed, 30-Dec-2037 16:00:00 GMT" Domains="bing.com;atdmt.com;live.com;" IgnoreRememberMe="false">@Model.Token</psf:extProperty>
                <psf:extProperty Name="LastUsedCredType">1</psf:extProperty>
                <psf:extProperty Name="WebCredType">1</psf:extProperty>
                <psf:extProperty Name="CID">@Model.CID</psf:extProperty>
            </psf:extProperties>
            <psf:response />
        </psf:pp>
    </S:Header>
    <S:Body>
        <wst:RequestSecurityTokenResponseCollection xmlns:S="http://www.w3.org/2003/05/soap-envelope" xmlns:wst="http://schemas.xmlsoap.org/ws/2005/02/trust" xmlns:wsse="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-secext-1.0.xsd" xmlns:wsu="http://docs.oasis-open.org/wss/2004/01/oasis-200401-wss-wssecurity-utility-1.0.xsd" xmlns:saml="urn:oasis:names:tc:SAML:1.0:assertion" xmlns:wsp="http://schemas.xmlsoap.org/ws/2004/09/policy" xmlns:psf="http://schemas.microsoft.com/Passport/SoapServices/SOAPFault">
            <wst:RequestSecurityTokenResponse>
                <wst:TokenType>urn:passport:legacy</wst:TokenType>
                <wsp:AppliesTo xmlns:wsa="http://www.w3.org/2005/08/addressing">
                    <wsa:EndpointReference>
                        <wsa:Address>http://Passport.NET/tb</wsa:Address>
                    </wsa:EndpointReference>
                </wsp:AppliesTo>
                <wst:Lifetime>
                    <wsu:Created>@Model.TimeZ</wsu:Created>
                    <wsu:Expires>@Model.TomorrowZ</wsu:Expires>
                </wst:Lifetime>
                <wst:RequestedSecurityToken>
                    <EncryptedData xmlns="http://www.w3.org/2001/04/xmlenc#" Id="BinaryDAToken0" Type="http://www.w3.org/2001/04/xmlenc#Element">
                        <EncryptionMethod Algorithm="http://www.w3.org/2001/04/xmlenc#tripledes-cbc"></EncryptionMethod>
                        <ds:KeyInfo xmlns:ds="http://www.w3.org/2000/09/xmldsig#">
                            <ds:KeyName>http://Passport.NET/STS</ds:KeyName>
                        </ds:KeyInfo>
                        <CipherData>
                            <CipherValue>Cap26AQZrSyMm2SwwTyJKyqLR9/S+vQWQsaBc5Mv7PwtQDMzup/udOOMMvSu99R284pmiD3IepBXrEMLK5rLrXAf2A6vrP6vYuGA45GCqQdoxusHZcjt9P2B8WyCTVT2cM8jtGqGIfRlU/4WzOLxNrDJwDfOsmilduGAGZfvRPW7/jyXXrnGK7/PWkymX4YDD+ygJfMrPAfvAprvw/HVE6tutKVc9cViTVYy8oHjosQlb8MKn3vKDW1O2ZWQUc47JPl7DkjQaanfNBGe6CL7K1nr6Z/jy7Ay7MjV+KQehmvphSEmCzLrpB4WWn2PdpdTrOcDj+aJfWHeGL4sIPwEKgrKnTQg9QD8CCsm5wew9P/br39OuIfsC6/PFBEHmVThqj0aMxYLRD4K2GoRay6Ab7NftoIP5dnFnclfRxETAoNpTPE2F5Q669QySrdXxBpBSk8GLmdCDMlhiyzSiByrhFQaZRcH8n9i+i289otYuJQ7xPyP19KwT4CRyOiIlh3DSdlBfurMwihQGxN2spU7P4MwckrDKeOyYQhvNm/XWId/oXBqpHbo2yRPiOwL9p1J4AxA4RaJuh77vyhn2lFQaxPDqZd5A8RJjpb2NE2N3UncKLW7GAangdoLbRDMqt51VMZ0la+b/moL61fKvFXinKRHc7PybrG3MWzgXxO/VMKAuXOsB9XnOgl2A524cgiwyg==</CipherValue>
                        </CipherData>
                    </EncryptedData>
                </wst:RequestedSecurityToken>
                <wst:RequestedAttachedReference>
                    <wsse:SecurityTokenReference>
                        <wsse:Reference URI="2jmj7l5rSw0yVb/vlWAYkK/YBwk="></wsse:Reference>
                    </wsse:SecurityTokenReference>
                </wst:RequestedAttachedReference>
                <wst:RequestedUnattachedReference>
                    <wsse:SecurityTokenReference>
                        <wsse:Reference URI="2jmj7l5rSw0yVb/vlWAYkK/YBwk="></wsse:Reference>
                    </wsse:SecurityTokenReference>
                </wst:RequestedUnattachedReference>
                <wst:RequestedProofToken>
                    <wst:BinarySecret>tgoPVK67sU36fQKlGLMgWgTXp7oiaQgE</wst:BinarySecret>
                </wst:RequestedProofToken>
            </wst:RequestSecurityTokenResponse>
            @for (var i = 0; i < Model.Tokens.Length; i++)
            {
                var token = Model.Tokens[i];

                <wst:RequestSecurityTokenResponse>
                    <wst:TokenType>urn:passport:compact</wst:TokenType>
                    <wsp:AppliesTo xmlns:wsa="http://www.w3.org/2005/08/addressing">
                        <wsa:EndpointReference>
                            <wsa:Address>@token.Domain</wsa:Address>
                        </wsa:EndpointReference>
                    </wsp:AppliesTo>
                    <wst:Lifetime>
                        <wsu:Created>@Model.TimeZ</wsu:Created>
                        <wsu:Expires>@Model.TomorrowZ</wsu:Expires>
                    </wst:Lifetime>
                    <wst:RequestedSecurityToken>
                        <wsse:BinarySecurityToken Id="Compact@(i)">t=@(token.Token)&amp;p=</wsse:BinarySecurityToken>
                    </wst:RequestedSecurityToken>
                    <wst:RequestedAttachedReference>
                        <wsse:SecurityTokenReference>
                            <wsse:Reference URI="/DaESnwwMVTTpRTZEoNqUW/Md0k="></wsse:Reference>
                        </wsse:SecurityTokenReference>
                    </wst:RequestedAttachedReference>
                    <wst:RequestedUnattachedReference>
                        <wsse:SecurityTokenReference>
                            <wsse:Reference URI="/DaESnwwMVTTpRTZEoNqUW/Md0k="></wsse:Reference>
                        </wsse:SecurityTokenReference>
                    </wst:RequestedUnattachedReference>
                    @if (token.Domain == "messengerclear.live.com")
                    {
                        <wst:RequestedProofToken>
                            <wst:BinarySecret>@token.Token</wst:BinarySecret>
                        </wst:RequestedProofToken>
                    }
                </wst:RequestSecurityTokenResponse>
            }
        </wst:RequestSecurityTokenResponseCollection>
    </S:Body>
</S:Envelope>
